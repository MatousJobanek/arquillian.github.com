<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Guía de introducción: Aclarar y repetir &#183; Arquillian Guides</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <meta content="Segunda parte de la guía de introducción. Revisa tu avance explorando un ejemplo un poco más complejo y aprende cómo usar contenedores remotos." name="description" />
    <link href="/blog/atom.xml" rel="alternate" title="Arquillian blog Atom feed" type="application/atom+xml" />
    <link href="/stylesheets/screen.css?9af4bcf5a328ba81be7679268e4a9f4eefe09ea1" rel="stylesheet" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/r29/html5.js"></script>
    <![endif]-->
    <link href="/favicon.ico" rel="shortcut icon" />
  </head>
  <body class="guide">
    <header class="navbar navbar-fixed-top" id="banner" role="banner">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <div class="g-plusone-slot">
            <div class="g-plusone" data-annotation="none"></div>
          </div>
          <a class="brand" href="/">
            <span class="logo"></span>
            <span class="name">Arquillian</span>
          </a>
          <nav class="nav-collapse" role="navigation">
            <ul class="nav">
              <li><a href="/invasion/">Invasion!</a></li>
              <li><a href="/features/">Features</a></li>
              <li class="active"><a href="/guides/">Guides</a></li>
              <li><a href="/docs/">Docs</a></li>
              <li><a href="/blog/">Blog</a></li>
              <li><a href="/community/">Community</a></li>
              <li><a href="/modules/">Modules</a></li>
            </ul>
          </nav>
        </div>
      </div>
    </header>
    <div id="main" role="main">
      <div id="content-header">
        <div class="container">
          <div class="headline">
            <h1>
              <a href="/guides/">Arquillian Guides</a>
              <small>Designed exclusively to teach you how to use Arquillian to write real tests.</small>
            </h1>
            <div class="directory">
              <a class="guides_menu" href="./" id="guides_menu">
                Guides Index
                <i class="icon-menu-closed"></i>
              </a>
              <div id="guides" style="display: none">
                <a class="guides_menu" href="./">
                  Guides Index
                  <i class="icon-menu-open"></i>
                </a>
                <hr class="clear" />
                <dl class="beg">
                  <dt>First Steps</dt>
                  <dd><a href="/guides/getting_started/">Getting Started</a>
                  <br />
                  <a href="/guides/getting_started/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
                  <a href="/guides/getting_started_de/"><img class="flag" rel="tooltip" src="/images/flags/de.png" title="Deutsch (de)" /></a>
                  <a href="/guides/getting_started_el_gr/"><img class="flag" rel="tooltip" src="/images/flags/el_gr.png" title="Ελληνικά (el_gr)" /></a>
                  <a href="/guides/getting_started_es/"><img class="flag" rel="tooltip" src="/images/flags/es.png" title="Español (es)" /></a>
                  <a href="/guides/getting_started_fr/"><img class="flag" rel="tooltip" src="/images/flags/fr.png" title="Française (fr)" /></a>
                  <a href="/guides/getting_started_it/"><img class="flag" rel="tooltip" src="/images/flags/it.png" title="Italiano (it)" /></a>
                  <a href="/guides/getting_started_ja/"><img class="flag" rel="tooltip" src="/images/flags/ja.png" title="日本 (ja)" /></a>
                  <a href="/guides/getting_started_nl/"><img class="flag" rel="tooltip" src="/images/flags/nl.png" title="Nederlands (nl)" /></a>
                  <a href="/guides/getting_started_pl/"><img class="flag" rel="tooltip" src="/images/flags/pl.png" title="Polski (pl)" /></a>
                  <a href="/guides/getting_started_pt/"><img class="flag" rel="tooltip" src="/images/flags/pt.png" title="Português (pt)" /></a>
                  <a href="/guides/getting_started_sk/"><img class="flag" rel="tooltip" src="/images/flags/sk.png" title="Slovenčina (sk)" /></a>
                  <a href="/guides/getting_started_sv_se/"><img class="flag" rel="tooltip" src="/images/flags/sv_se.png" title="Svenska (sv_se)" /></a>
                  <a href="/guides/getting_started_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
                  <dd><a href="/guides/getting_started_rinse_and_repeat/">Getting Started: Rinse and Repeat</a>
                  <br />
                  <a href="/guides/getting_started_rinse_and_repeat/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_de/"><img class="flag" rel="tooltip" src="/images/flags/de.png" title="Deutsch (de)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_es/"><img class="flag" rel="tooltip" src="/images/flags/es.png" title="Español (es)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_fr/"><img class="flag" rel="tooltip" src="/images/flags/fr.png" title="Française (fr)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_it/"><img class="flag" rel="tooltip" src="/images/flags/it.png" title="Italiano (it)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_ja/"><img class="flag" rel="tooltip" src="/images/flags/ja.png" title="日本 (ja)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_pl/"><img class="flag" rel="tooltip" src="/images/flags/pl.png" title="Polski (pl)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_pt/"><img class="flag" rel="tooltip" src="/images/flags/pt.png" title="Português (pt)" /></a>
                  <a href="/guides/getting_started_rinse_and_repeat_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
                  <dd><a href="/guides/get_started_faster_with_forge/">Get Started Faster with Forge</a></dd>
                  <dd><a href="/guides/shrinkwrap_introduction/">Creating Deployable Archives with ShrinkWrap</a>
                  <br />
                  <a href="/guides/shrinkwrap_introduction/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
                  <a href="/guides/shrinkwrap_introduction_de/"><img class="flag" rel="tooltip" src="/images/flags/de.png" title="Deutsch (de)" /></a>
                  <a href="/guides/shrinkwrap_introduction_fr/"><img class="flag" rel="tooltip" src="/images/flags/fr.png" title="Française (fr)" /></a>
                  <a href="/guides/shrinkwrap_introduction_it/"><img class="flag" rel="tooltip" src="/images/flags/it.png" title="Italiano (it)" /></a>
                  <a href="/guides/shrinkwrap_introduction_ja/"><img class="flag" rel="tooltip" src="/images/flags/ja.png" title="日本 (ja)" /></a>
                  <a href="/guides/shrinkwrap_introduction_pl/"><img class="flag" rel="tooltip" src="/images/flags/pl.png" title="Polski (pl)" /></a>
                  <a href="/guides/shrinkwrap_introduction_pt/"><img class="flag" rel="tooltip" src="/images/flags/pt.png" title="Português (pt)" /></a>
                  <a href="/guides/shrinkwrap_introduction_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
                </dl>
                <dl class="int">
                  <dt>More Coverage</dt>
                  <dd><a href="/guides/testing_java_persistence/">Testing Java Persistence</a>
                  <br />
                  <a href="/guides/testing_java_persistence/"><img class="flag" rel="tooltip" src="/images/flags/en.png" title="English (en)" /></a>
                  <a href="/guides/testing_java_persistence_de/"><img class="flag" rel="tooltip" src="/images/flags/de.png" title="Deutsch (de)" /></a>
                  <a href="/guides/testing_java_persistence_es/"><img class="flag" rel="tooltip" src="/images/flags/es.png" title="Español (es)" /></a>
                  <a href="/guides/testing_java_persistence_fr/"><img class="flag" rel="tooltip" src="/images/flags/fr.png" title="Française (fr)" /></a>
                  <a href="/guides/testing_java_persistence_ja/"><img class="flag" rel="tooltip" src="/images/flags/ja.png" title="日本 (ja)" /></a>
                  <a href="/guides/testing_java_persistence_zh_cn/"><img class="flag" rel="tooltip" src="/images/flags/zh_cn.png" title="简体中文 (zh_cn)" /></a></dd>
                  <dd><a href="/guides/functional_testing_using_graphene/">Functional Testing using Drone and Graphene</a></dd>
                  <dd><a href="/guides/testing_in_the_cloud/">Testing in the Cloud</a></dd>
                </dl>
                <dl class="adv">
                  <dt>Enhance</dt>
                  <dd><a href="/guides/developing_a_container_adapter/">Developing a Container Adapter</a></dd>
                </dl>
                <dl class="ref">
                  <dt>Reference</dt>
                  <dd><a href="https://docs.jboss.org/author/display/ARQ/Reference+Guide">Reference Guide</a></dd>
                  <dd><a href="http://docs.jboss.org/arquillian/aggregate/latest">API &amp; SPI Docs</a></dd>
                  <dd><a href="http://community.jboss.org/wiki/ArquillianMigrationGuides">Migration Guides</a></dd>
                  <dd><a href="http://community.jboss.org/en/arquillian/faq">FAQs</a></dd>
                </dl>
              </div>
            </div>
            <script>$(function() { activateGuideMenuControl() })</script>
          </div>
        </div>
      </div>
      <div class="container" id="guide">
        <div id="content" lang="es">
            <div class="header">
            <div class="titlebar">
            <h2>Guía de introducción: Aclarar y repetir</h2>
            <div class="btn-group">
              <a class="btn" href="https://github.com/arquillian/arquillian.github.io/edit/develop/guides/getting_started_rinse_and_repeat_es.textile">Edit this file</a>
            </div>
          </div>
            <div class="authors"><strong>Author:</strong>
          <a href="/community/mojavelinux">Dan Allen</a>  <strong style="padding-left: 10px;">Translator:</strong>
          <a href="/community/csierra">Carlos Sierra Andrés</a>  <strong style="padding-left: 10px;">Language:</strong>
          <img class="flag" rel="tooltip" src="/images/flags/es.png" title="Español (es)" />
          <br />
          <strong style="padding-left: 0px;">Last Update:</strong>Mar 31, 2017</div>
            <p>En esta continuación de la <a href="/guides/getting_started_es">Guía de introducción</a>, tendrás la oportunidad de recapitular lo que has aprendido sobre Arquillian explorando un ejemplo ligeramente más complejo. Después de leer esta guía serás capaz de:</p>
            <ul>
          	<li>Escribir un test de Arquillian que use <acronym title="Contexts and Dependency Injection">CDI</acronym> y <acronym title="Enterprise JavaBeans">EJB</acronym> al mismo tiempo</li>
          	<li>Ejecutar un test de Arquillian en un contenedor remoto</li>
          	<li>Depurar un test de Arquillian en un contedor remoto</li>
          </ul>
            <p>Como parte del aprendizaje añadirás perfiles de Maven adicionales al proyecto. Cuando los actives, estos perfiles harán que Arquillian ejecute los tests en el contenedor remoto (por ejemplo el servidor de aplicaciones). Lo que significa que vas a probar la aplicación real, sin piedras ni cartones. Nada de mocks ni de entornos embebidos. Y como ya has hecho lo más difícil en la guía anterior, no te va costar mucho conseguirlo.</p>
            </div>
            <h3 id="asunciones">Asunciones</h3>
          <p>En esta guía se asume que ya has añadido la infraestructura de Arquillian a tu proyecto y que has escrito y ejecutado al menos un test de Arquillian. Si no lo has hecho todavía, por favor léete la <a href="/guides/getting_started_es">Guía de introducción</a> para familiarizarte con los fundamentos de Arquillian. También necesitaras el software requerido que se menciona en esa guía.</p>
          <h3 id="crear_los_componentes">Crear los componentes</h3>
          <p>En esta guía vamos a crear un backend básico para una aplicación de tienda online. Vamos a crear un componente de cesta de la compra para guardar las cosas seleccionadas por el visitante y un componente para un repositorio donde guardar y recuperar los pedidos. Implementaremos estos componentes utilizando CDI y EJB respectivamente. Podemos empezar a utilizar estos dos nuevos modelos de programación inmediatamente ya que ya disponemos del API de Java EE 6 en el classpath. (Consulta la <a href="/guides/getting_started_es">Guía de introducción</a> si necesitas instrucciones adicionales para añadir este API en tu proyecto)</p>
          <p>Comencemos con un componente que mueve los pedidos hacia el almacenamiento persistente y viceversa. Siguiendo directrices para un buen diseño de software, y para simplificar los tests, empezaremos definiendo una interfaz que establezca el contrato. En el IDE, crea una nueva interfaz EJB local que se llame <code>OrderRepository</code> y rellénala con el siguiente contenido:</p>
          <div class="filename">src/main/java/org/arquillian/example/OrderRepository.java</div>
          <pre class="prettify"><code class="prettify">package org.arquillian.example;</code>&#x000A;&#x000A;<code class="prettify">import java.util.List;&#x000A;import javax.ejb.Local;</code>&#x000A;&#x000A;<code class="prettify">@Local&#x000A;public interface OrderRepository {&#x000A;    void addOrder(List&lt;String&gt; order);&#x000A;    List&lt;List&lt;String&gt;&gt; getOrders();&#x000A;    int getOrderCount();&#x000A;}</code></pre>
          <p>Nos ocuparemos de la implementación un poco más adelante. Vamos a ver ahora cómo usar este contrato.</p>
          <p>Según vayan los visitantes navegando por el sitio irán metiendo objetos en la cesta para comprarlos. Para modelar este escenario vamos a usar un bean de CDI que esté asociado con la sesión HTTP del visitante. Este componente delegará en el <code>OrderRepository</code> (repositorio de pedidos) cuando el visitante quiera comprar los objetos seleccionados.</p>
          <p>En el IDE, crea una clase que se llame <code>Basket</code> y engánchala al contexto de la sesión HTTP añadiéndole la anotación <code>@SessionScoped</code> tal y como se muestra a continuación:</p>
          <div class="filename">src/main/java/org/arquillian/example/Basket.java</div>
          <pre class="prettify"><code class="prettify">package org.arquillian.example;</code>&#x000A;&#x000A;<code class="prettify">import java.io.Serializable;&#x000A;import java.util.ArrayList;&#x000A;import java.util.Collections;&#x000A;import java.util.List;</code>&#x000A;&#x000A;<code class="prettify">import javax.annotation.PostConstruct;&#x000A;import javax.ejb.EJB;&#x000A;import javax.enterprise.context.SessionScoped;</code>&#x000A;&#x000A;<code class="prettify">@SessionScoped&#x000A;public class Basket implements Serializable {&#x000A;    private static final long serialVersionUID = 1L;&#x000A;    private List&lt;String&gt; items;</code>&#x000A;    &#x000A;<code class="prettify">    @EJB&#x000A;    private OrderRepository repo;</code>&#x000A;    &#x000A;<code class="prettify">    public void addItem(String item) {&#x000A;        items.add(item);&#x000A;    }</code>&#x000A;    &#x000A;<code class="prettify">    public List&lt;String&gt; getItems() {&#x000A;        return Collections.unmodifiableList(items);&#x000A;    }</code>&#x000A;    &#x000A;<code class="prettify">    public int getItemCount() {&#x000A;        return items.size();&#x000A;    }</code>&#x000A;    &#x000A;<code class="prettify">    public void placeOrder() {&#x000A;        repo.addOrder(items);&#x000A;        items.clear();&#x000A;    }</code>&#x000A;    &#x000A;<code class="prettify">    @PostConstruct&#x000A;    void initialize() {&#x000A;        items = new ArrayList&lt;String&gt;();&#x000A;    }&#x000A;}</code></pre>
          <p>Como podrás ver, estamos inyectando un EJB a un bean de CDI ¡Justo la integración que queremos probar!</p>
          <h3 id="implementaci&#243;n_por_fases">Implementación por fases</h3>
          <p>No estamos listos todavía para escribir el test, ya que no tenemos todavía una implementación del <code>OrderRepository</code>.</p>
          <p>Para el propósito del ejemplo asumiremos que otro equipo está implementado el <code>OrderRepository</code> (o que se va a implementar en otra iteración). Aqui es donde destaca realmente la capacidad de micro-despliegues de Arquillian. Podemos crear una implementación &#8220;de memoria temporal&#8221;, con un EJB singleton, y empaquetarlo en el archivo del test para conseguir tener una aplicación funcional en el corto plazo. Puede que incluso decidamos guardar esta implementación para probar este extremo posteriormente.</p>
          <p>Crea una clase <code>SingletonOrderRepository</code> en tu <em>test classpath</em> y rellénala con el código que se muestra a continuación:</p>
          <div class="filename">src/test/java/org/arquillian/example/SingletonOrderRepository.java</div>
          <pre class="prettify"><code class="prettify">package org.arquillian.example;</code>&#x000A;&#x000A;<code class="prettify">import java.util.ArrayList;&#x000A;import java.util.Collections;&#x000A;import java.util.List;</code>&#x000A;&#x000A;<code class="prettify">import javax.annotation.PostConstruct;&#x000A;import javax.ejb.Lock;&#x000A;import javax.ejb.LockType;&#x000A;import javax.ejb.Singleton;</code>&#x000A;&#x000A;<code class="prettify">@Singleton&#x000A;@Lock(LockType.READ)&#x000A;public class SingletonOrderRepository implements OrderRepository {&#x000A;    private List&lt;List&lt;String&gt;&gt; orders;</code>&#x000A;    &#x000A;<code class="prettify">    @Override&#x000A;    @Lock(LockType.WRITE)&#x000A;    public void addOrder(List&lt;String&gt; order) {&#x000A;        orders.add(order);&#x000A;    }</code>&#x000A;    &#x000A;<code class="prettify">    @Override&#x000A;    public List&lt;List&lt;String&gt;&gt; getOrders() {&#x000A;        return Collections.unmodifiableList(orders);&#x000A;    }</code>&#x000A;    &#x000A;<code class="prettify">    @Override&#x000A;    public int getOrderCount() {&#x000A;        return orders.size();&#x000A;    }</code>&#x000A;    &#x000A;<code class="prettify">    @PostConstruct&#x000A;    void initialize() {&#x000A;        orders = new ArrayList&lt;List&lt;String&gt;&gt;();&#x000A;    }&#x000A;}</code></pre>
          <p>La ventaja que tiene esta implementación es que tenemos la oportunidad de jugar con la nueva funcionalidad singleton de EJB 3.1 en un entorno seguro (sandbox) de Arquillian. Por eso nos gusta decir que Arquillian es un entorno de aprendizaje, además de ser una herramienta para pruebas.</p>
          <p>Ahora sí estamos listos para escribir el test de Arquillian.</p>
          <h3 id="escribir_un_test">Escribir un test</h3>
          <p>Ahora vamos a escribir un test que simule el añadir objetos a una instancia de <code>Basket</code>, usa esa instancia para colocar un pedido y después valida que el pedido se procesa y se guarda en la única instancia de <code>OrderRepository</code>.</p>
          <p class="info"><span>Por supuesto solo vamos a probar la implementación de &#8220;memoria temporal&#8221;. Aprenderemos cómo escribir un test que use una base de datos en la guía <a href="/guides/testing_java_persistence">Testing Java Persistence</a>. Entonces puedes volver a esta guía y profundizar en la implementación de JPA</span></p>
          <p>Crea la clase <code>BasketTest</code> y anótala con <code>@RunWith(Arquillian.class)</code> para convertirla en un test de Arquillian:</p>
          <div class="filename">src/test/java/org/arquillian/example/BasketTest.java</div>
          <pre class="prettify"><code class="prettify">package org.arquillian.example;</code>&#x000A;&#x000A;<code class="prettify">import org.jboss.arquillian.junit.Arquillian;&#x000A;import org.junit.runner.RunWith;</code>&#x000A;&#x000A;<code class="prettify">@RunWith(Arquillian.class)&#x000A;public class BasketTest {&#x000A;}</code></pre>
          <p>Lo siguiente que haremos será definir un archivo de test que incluya la cesta de la compra, la interfaz del repositorio de pedidos y su implementación singleton. Necesitamos también un fichero beans.xml vacío para activar el CDI (EJB se activa automáticamente). Date cuenta de que tenemos control total sobre el classpath, ya que definimos explícitamente lo que va a ir dentro del fichero.</p>
          <div class="filename">src/test/java/org/arquillian/example/BasketTest.java</div>
          <pre class="prettify"><code class="prettify">package org.arquillian.example;</code>&#x000A;&#x000A;<code class="prettify">import org.jboss.arquillian.container.test.api.Deployment;&#x000A;import org.jboss.arquillian.junit.Arquillian;&#x000A;import org.jboss.shrinkwrap.api.ShrinkWrap;&#x000A;import org.jboss.shrinkwrap.api.asset.EmptyAsset;&#x000A;import org.jboss.shrinkwrap.api.spec.JavaArchive;&#x000A;import org.junit.runner.RunWith;</code>&#x000A;&#x000A;<code class="prettify">@RunWith(Arquillian.class)&#x000A;public class BasketTest {&#x000A;    @Deployment&#x000A;    public static JavaArchive createDeployment() {&#x000A;        return ShrinkWrap.create(JavaArchive.class, "test.jar")&#x000A;            .addClasses(Basket.class, OrderRepository.class, SingletonOrderRepository.class)&#x000A;            .addAsManifestResource(EmptyAsset.INSTANCE, "beans.xml");&#x000A;    }&#x000A;}</code></pre>
          <p>Lo único que queda es inyectar la cesta de la compra y el repositorio de pedidos en el test y comprobar su interacción. Inyectamos la interfaz EJB, no la implementación. El contenedor de EJB encontrará la implementación de la interfaz que usemos automáticamente.</p>
          <p>En JUnit, por defecto, los methodos <code>@Test</code> se ejecutan en orden aleatorio. La integración con JUnit de Arquillian proporciona una anotación <code>@InSequence</code> que se puede usar para definir un orden de ejecución explícito. Vamos a usar <code>@InSequence</code> en esta prueba para garantizar, en el segundo test, que el repositorio contiene el número correcto de elementos en el pedido que creamos en el primer test.</p>
          <div class="filename">src/test/java/org/arquillian/example/BasketTest.java</div>
          <pre class="prettify"><code class="prettify">package org.arquillian.example;</code>&#x000A;&#x000A;<code class="prettify">import javax.ejb.EJB;&#x000A;import javax.inject.Inject;</code>&#x000A;&#x000A;<code class="prettify">import org.jboss.arquillian.container.test.api.Deployment;&#x000A;import org.jboss.arquillian.junit.Arquillian;&#x000A;import org.jboss.arquillian.junit.InSequence;&#x000A;import org.jboss.shrinkwrap.api.ShrinkWrap;&#x000A;import org.jboss.shrinkwrap.api.asset.EmptyAsset;&#x000A;import org.jboss.shrinkwrap.api.spec.JavaArchive;&#x000A;import org.junit.Assert;&#x000A;import org.junit.Test;&#x000A;import org.junit.runner.RunWith;</code>&#x000A;&#x000A;<code class="prettify">@RunWith(Arquillian.class)&#x000A;public class BasketTest {&#x000A;    @Deployment&#x000A;    public static JavaArchive createDeployment() {&#x000A;        return ShrinkWrap.create(JavaArchive.class, "test.jar")&#x000A;            .addClasses(Basket.class, OrderRepository.class, SingletonOrderRepository.class)&#x000A;            .addAsManifestResource(EmptyAsset.INSTANCE, "beans.xml");&#x000A;    }</code>&#x000A;    &#x000A;<code class="prettify">    @Inject&#x000A;    Basket basket;</code>&#x000A;    &#x000A;<code class="prettify">    @EJB&#x000A;    OrderRepository repo;</code>&#x000A;    &#x000A;<code class="prettify">    @Test&#x000A;    @InSequence(1)&#x000A;    public void place_order_should_add_order() {&#x000A;        basket.addItem("sunglasses");&#x000A;        basket.addItem("suit");&#x000A;        basket.placeOrder();&#x000A;        Assert.assertEquals(1, repo.getOrderCount());&#x000A;        Assert.assertEquals(0, basket.getItemCount());</code>&#x000A;        &#x000A;<code class="prettify">        basket.addItem("raygun");&#x000A;        basket.addItem("spaceship");&#x000A;        basket.placeOrder();&#x000A;        Assert.assertEquals(2, repo.getOrderCount());&#x000A;        Assert.assertEquals(0, basket.getItemCount());&#x000A;    }</code>&#x000A;    &#x000A;<code class="prettify">    @Test&#x000A;    @InSequence(2)&#x000A;    public void order_should_be_persistent() {&#x000A;        Assert.assertEquals(2, repo.getOrderCount());&#x000A;    }&#x000A;}</code></pre>
          <p>El test está escrito. Ahora tenemos que prepararnos para ejecutarlo.</p>
          <h3 id="a&#241;adir_los_contenedores_remotos">Añadir los Contenedores Remotos</h3>
          <p>El test que hemos escrito usa tanto CDI como EJB. Esta combinación excede la funcionalidad que pueden ofrecer los contenedores embebidos (como Weld Embedded o OpenEJB Embedded). En cualquier caso es más sencillo utilizar un contenedor Java EE compatible. Además nos proporciona resultados más precisos, con lo que dejaremos los contenedores embebidos por ahora.</p>
          <p>En la guía anterior usamos tanto contenedores embebidos como administrados. En ambos casos Arquillian tiene que iniciar el contenedor cuando la serie de tests comience y pararlo cuando los tests hayan acabado. ¿Qué pasa si ya tienes un contenedor arrancado (o si quieres arrancar uno para el propósito de los tests)? Obviamente esa va a ser la manera más rápida de ejecutar los tests. Incluso si el contenedor arrancase muy rápido no hay comparación con tenerlo ya arrancado.</p>
          <p>Los contenedores remotos suponen un entorno de desarrollo ideal para las pruebas de integración. También la depuración de los tests se simplifica mucho, como podrás comprobar más adelante. Ya que no hay ninguna referencia al contenedor en el test, usar un contenedor remoto durante el desarrollo no te impide usar uno administrado para la integración continua. De hecho, los contenedores administrados son los más adecuados en un entorno de integración continua.</p>
          <p class="warning"><span>El término <em>remoto</em> se refiere a un proceso distinto, no necesariamente una máquina distinta, aunque soporta los dos escenarios.</span></p>
          <p>Un contenedor remoto es un proceso independiente en el que Arquillian despliega usando las API de cliente de despliegue del contenedor. Por lo tanto, las librerías que necesitas son:</p>
          <ul>
          	<li>APIs del modelo de programación (solo necesitas empaquetarlas en caso de que el contenedor no las provea)</li>
          	<li>El adaptador de Arquillian para el contenedor remoto.</li>
          	<li>Las APIs del cliente de despliegues para comunicar con el proceso contenedor.</li>
          </ul>
          <p>En tu fichero pom.xml de Maven, añade dos nuevos perfiles dentro del elemento <code>&lt;profiles&gt;</code>. El primer perfil usa un contenedor JBoss AS 7.1 remoto:</p>
          <div class="filename">pom.xml</div>
          <pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;profile&gt;&#x000A;    &lt;id&gt;arquillian-jbossas-remote&lt;/id&gt;&#x000A;    &lt;dependencies&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.jboss.spec&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;jboss-javaee-6.0&lt;/artifactId&gt;&#x000A;            &lt;version&gt;1.0.0.Final&lt;/version&gt;&#x000A;            &lt;type&gt;pom&lt;/type&gt;&#x000A;            &lt;scope&gt;provided&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.jboss.as&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;jboss-as-arquillian-container-remote&lt;/artifactId&gt;&#x000A;            &lt;version&gt;7.1.1.Final&lt;/version&gt;&#x000A;            &lt;scope&gt;test&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.jboss.arquillian.protocol&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;arquillian-protocol-servlet&lt;/artifactId&gt;&#x000A;            &lt;scope&gt;test&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;    &lt;/dependencies&gt;&#x000A;&lt;/profile&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
          <p class="info"><span>Por defecto JBoss AS 7 despliega los archivos de test al servidor usando el protocolo JMX. Nos hemos adelantado y hemos añadido la dependencia del protocolo servlet en el perfil <code>arquillian-jbossas-managed</code> para que esté ahí en caso de que lo necesites usar más adelante. Echa un vistazo a <a href="https://community.jboss.org/wiki/WhyDoIGetNoActiveContextsForScopeTypeWhenTestingOnJBossAS7">estas preguntas frecuentes</a> si quieres instrucciones para activarlo.</span></p>
          <p>El segundo perfil usa un contenedor GlassFish 3.1.2 remoto:</p>
          <div class="filename">pom.xml</div>
          <pre class="prettify"><code class="prettify">&lt;!-- clip --&gt;&#x000A;&lt;profile&gt;&#x000A;    &lt;id&gt;arquillian-glassfish-remote&lt;/id&gt;&#x000A;    &lt;dependencies&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.jboss.spec&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;jboss-javaee-6.0&lt;/artifactId&gt;&#x000A;            &lt;version&gt;1.0.0.Final&lt;/version&gt;&#x000A;            &lt;type&gt;pom&lt;/type&gt;&#x000A;            &lt;scope&gt;provided&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.jboss.weld&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;weld-api&lt;/artifactId&gt;&#x000A;            &lt;version&gt;1.1.Final&lt;/version&gt;&#x000A;            &lt;scope&gt;test&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;        &lt;dependency&gt;&#x000A;            &lt;groupId&gt;org.jboss.arquillian.container&lt;/groupId&gt;&#x000A;            &lt;artifactId&gt;arquillian-glassfish-remote-3.1&lt;/artifactId&gt;&#x000A;            &lt;version&gt;1.0.0.CR3&lt;/version&gt;&#x000A;            &lt;scope&gt;test&lt;/scope&gt;&#x000A;        &lt;/dependency&gt;&#x000A;    &lt;/dependencies&gt;&#x000A;&lt;/profile&gt;&#x000A;&lt;!-- clip --&gt;</code></pre>
          <p class="info"><span>El adaptador para GlassFish remoto utiliza Jersey para comunicarse con el contenedor vía JAX-RS (REST), el cual se descarga como una dependencia transitiva. El API de Weld se necesita para reconstruir las excepciones que devuelven los test ejecutados en el contenedor.</span></p>
          <p>Una vez que has añadido los perfiles al pox.xml, haz click con el botón derecho en el proyecto de Eclipse y selecciona Maven &gt; Update Project Configuration. Si el proyecto te da errores de compilación entonces tienes que activar uno de los perfiles.</p>
          <p>Recuerda que hay dos maneras de activar un perfil de Maven en Eclipse (dando por hecho que estás usando <a href="http://www.eclipse.org/m2e">Maven Integration for Eclipse</a>):</p>
          <ol>
          	<li>Configuración manual (aproximación estándar)</li>
          	<li>Selector de perfiles de Maven (JBoss Tools)</li>
          </ol>
          <p>Consulta la <a href="/guides/getting_started_es#pruebas_sobre_varios_contenedores">Guía de introducción</a> para encontrar instrucciones sobre cómo activar un perfil. Una vez que has activado el perfil el proyecto debería compilar sin problemas.</p>
          <p>Los adaptadores de contenedores remotos esperan que los contenedores estén arrancados. Así que vamos a configurar los contenedores para que podamos arrancarlos desde la comodidad de nuestro IDE antes de que ejecutemos el test.</p>
          <h3 id="control_de_los_servidores">Control de los servidores</h3>
          <p>La manera más sencilla de administrar un contenedor remoto es configurarlo en el IDE. Si eres más de línea de comandos puedes saltarte este paso y arrancar los servidores usando los scripts de arranque apropiados.</p>
          <p>Vamos a mostrarte cómo añadir los controles del servidor (contenedor) en Eclipse. El proceso es similar en otros IDEs. Para Eclipse necesitas tanto <a href="http://jboss.org/tools">JBoss Tools</a> como <a href="http://marketplace.eclipse.org/content/glassfish-java-ee-application-server-plugin-eclipse/metrics">GlassFish Java EE Application Server Plugin</a>. Ambos están disponibles en el Eclipse MarketPlace.</p>
          <p>En Eclipse selecciona Window  &gt; Show View &gt; Servers en la barra de menu principal. Una vez que se abra la vista, haz click con el botón derecho y selecciona New &gt; Server. Crea un control para servidores JBoss AS 7.1:</p>
          <p><img src="/images/guides/arquillian_tutorial_2_new_jbossas_server.png" alt="" /></p>
          <p>y otro para GlassFish 3.1.2:</p>
          <p><img src="/images/guides/arquillian_tutorial_2_new_glassfish_server.png" alt="" /></p>
          <p class="info"><span>El asistente te pide que selecciones una instalación existente. El asistente para GlassFish 3.1.2 dispone de una opción para descargar y extraer la distribución automáticamente.</span></p>
          <p>Una vez que hayas completado los asistentes deberías ver sendos controles aparecer en la vista de servidores:</p>
          <p><img src="/images/guides/arquillian_tutorial_2_servers_view.png" alt="" /></p>
          <p>Para arrancar un servidor selecciona la entrada (como se muestra arriba en la imagen) y haz click en el botón verde con el símbolo del &#8220;Play&#8221; (Reproducir).</p>
          <p class="info"><span>Arquillian da por sentado que los contenedores están escuchando en los puertos por defecto. Si has cambiado los puertos puedes usar arquillian.xml para especificar los puertos que estés usando para cada contenedor. Consulta la <a href="https://docs.jboss.org/author/display/ARQ/Container+adapters">Guía de referencia</a> si quieres más detalles.</span></p>
          <p>Ahora que ya tienes los contenedores preparados y esperando, es hora de lanzarles el test.</p>
          <h3 id="ejecutar_el_test_con_arquillian">Ejecutar el test con Arquillian</h3>
          <p>Para ejecutar el test con Arquillian tienes que realizar los siguientes pasos:</p>
          <ol>
          	<li>Arrancar el contenedor remoto</li>
          	<li>Activar el perfil de Maven que añade el adaptador correspondiente para el contenedor en el classpath</li>
          	<li>Ejecutar el test</li>
          </ol>
          <p>Empecemos por JBoss AS.</p>
          <h4>Ejecutar el test en JBoss AS</h4>
          <p>Para ejecutar el test en JBoss AS comienza por arrancar el contenedor. Abre la vista de servidores, selecciona JBoss AS 7.1 y después haz click en el botón verde de &#8220;Play&#8221; (Reproducir). Espera a que arranque (no debería tardar mucho).</p>
          <p>Una vez que esté arrancado y funcionando activa el perfil de Maven <code>arquillian-jbossas-remote</code> usando bien la pestaña de propiedades de Maven o bien el selector de perfiles de Maven de JBoss Tools. Aquí abajo el selector de perfiles muestra la configuración correcta.</p>
          <p><img src="/images/guides/arquillian_tutorial_2_jbossas_profile_selection.png" alt="" /></p>
          <p>Finalmente haz click con el botón derecho sobre la clase <code>BasketTest</code> y selecciona Run As &gt; JUnit Test. Deberías ver una actividad frenética en la consola y después&#8230; ¡ <strong class="greenbar">Barra verde</strong> en la vista de JUnit!</p>
          <p>También puedes ejecutar el test en la línea de comandos utilizando Maven:</p>
          <pre class="command"><code class="command">$ mvn test -Parquillian-jbossas-remote -Dtest=BasketTest</code></pre>
          <p>Deberías ver lo siguiente impreso en la consola:</p>
          <pre class="output"><code class="output">-------------------------------------------------------&#x000A;T E S T S&#x000A;-------------------------------------------------------&#x000A;Running org.arquillian.example.BasketTest&#x000A;...&#x000A;Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 1.844 sec</code></pre>
          <p><strong>¡Enhorabuena!</strong> Te has ganado tu primera <strong class="greenbar">barra verde</strong> usando un contenedor remoto con Arquillian.</p>
          <p class="info"><span>También puedes inyectar el EJB <code>OrderRepository</code> usando <code>@Inject</code> en lugar de <code>@EJB</code>. ¡Pruébalo!</span></p>
          <p>Si quieres comprobar que el singleton esté realmente funcionando, reemplaza la anotación <code>@Singleton</code> en la clase <code>SingletonOrderRepository</code> con <code>@Stateful</code>. Deberías ver un error de verificación (assertion error) cuando ejecutes el test. Deshaz el cambio y la barra volverá a ser verde.</p>
          <p>Hemos terminado con JBoss AS por el momento, así que utiliza la vista de servidores para parar el servidor. Vamos a realizar exactamente la misma prueba en GlassFish 3.1.2.</p>
          <h4>Ejecutar el test en GlassFish</h4>
          <p>Para ejecutar el test en el servidor GlassFish independiente comienza arrancando el servidor. Abre la vista de servidores, selecciona GlassFish 3.1.2 y después haz click sobre el botón verde de &#8220;Play&#8221; (Reproducir). Espera a que arranque.</p>
          <p>Una vez que esté arrancado y funcionando activa el perfil de Maven <code>arquillian-glassfish-remote</code>, bien utilizando la pestaña de propiedades de Maven o bien el selector de perfiles de Maven de JBoss Tools. Acuérdate de desactivar el perfil <code>arquillian-jbossas-remote</code>. Abajo, en el editor de perfiles, se muestra la configuración correcta.</p>
          <p><img src="/images/guides/arquillian_tutorial_2_glassfish_profile_selection.png" alt="" /></p>
          <p>Finalmente haz click con el botón derecho sobre la clase <code>BasketTest</code> y selecciona Run As &gt; JUnit Test. Deberías ver una actividad frenética en la consola y después&#8230; ¡Una <strong class="greenbar">barra verde</strong> en la vista de JUnit!</p>
          <p>También puedes ejecutar el test en la línea de comandos usando Maven:</p>
          <pre class="command"><code class="command">$ mvn test -Parquillian-glassfish-remote -Dtest=BasketTest</code></pre>
          <p>Deberías ver las siguientes líneas impresas en la consola:</p>
          <pre class="output"><code class="output">-------------------------------------------------------&#x000A;T E S T S&#x000A;-------------------------------------------------------&#x000A;Running org.arquillian.example.BasketTest&#x000A;...&#x000A;Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.549 sec</code></pre>
          <p><strong>¡Enhorabuena!</strong> Te has ganado otra  <strong class="greenbar">barra verde</strong>.</p>
          <p>Deberías también poder ejecutar el test en el GlassFish Embebido usando el perfil que preparaste en la guía anterior. Inténtalo. Deberías también poder depurar el test fácilmente.</p>
          <p>Depurar el test en un contenedor embebido es, por supuesto, fácil ya que el test ejecuta en el mismo proceso que el lanzador de tests pero ¿Qué pasa con los contenedores remotos?</p>
          <h3 id="depurar_el_test_de_arquillian">Depurar el test de Arquillian</h3>
          <p>¿Depurar un test en un contenedor remoto? Suena difícil. ¡Sorpresa! No lo es en absoluto. Solo tienes que alterar uno de los pasos anteriores y añadir un paso adicional.</p>
          <ol>
          	<li><strong>Ejecuta el contenedor remoto en depuración (Debug)</strong></li>
          	<li>Activa el perfil de Maven que añade el adaptador correspondiente para el contenedor al classpath.</li>
          	<li><strong>Establece un punto de ruptura (breakpoint)</strong></li>
          	<li>Ejecuta el test</li>
          </ol>
          <p>En la vista de servidores deberías ver que hay un icono con un bicho (insecto) justo al lado del boton con el &#8220;Play&#8221; (Reproducir) verde. Pulsa este botón para arrancar el servidor seleccionado en modo depuración (Debug). Eclipse automáticamente conecta el depurador al contenedor.</p>
          <p>Establece un punto de ruptura (breakpoint) en el método <code>addOrder()</code> del bean <code>SingletonOrderRepository</code>. Ahora ejecuta otra vez el test con el botón derecho del ratón y seleccionando Run As &gt; JUnit Test.</p>
          <p class="warning"><span>No tienes que usar Debug As &gt; JUnit Test. El código del test se está ejecutando dentro del contenedor, el cual ya se está ejecutando en modo depuración.</span></p>
          <p>El test debería pararse en el punto de ruptura (breakpoint). Si estás usando JBoss AS puedes abrir la consola de administración y verificar que la aplicación de test está en este momento desplegada en el servidor.</p>
          <p>Si miras el stack trace en la vista de depuración de Eclipse (Debug View), verás que el servidor se controla mediante un protocolo remoto (ya sea JMX o Servlet) y que JUnit se ha lanzado también dentro del contenedor.</p>
          <p><img src="/images/guides/arquillian_tutorial_2_debug_remote_test.png" alt="" /></p>
          <p>Estás curioseando en el servidor desde la comodidad de tu IDE.</p>
          <p class="warning"><span>Si te aparece un mensaje &#8220;Source not found&#8221; (Código fuente no encontrado) en la vista del editor al pararse el depurador en el breakpoint, tienes que añadir el proyecto a la configuración de depuración. Haz click en &#8220;Edit Source Lookup Path&#8230;&#8221;, después haz click en &#8220;Add&#8230;&#8221;, selecciona Java Project, activa la casilla al lado de tu proyecto y después pulsa &#8220;OK&#8221;. ¡Voila! Código fuente</span></p>
          <h4>Depurando dentro (stepping into) de librerías externas</h4>
          <p>Si estabas pensando depurar dentro de una clase de una librería externa (código que se encuentra fuera de tu aplicación) necesitas enlazar la librería a su código fuente.</p>
          <p class="info"><span>No necesitas esta configuración si estás usando un proyecto de Maven y las fuentes de la librería están disponibles en el repositorio de Maven. Cuando llegues a un breakpoint en una librería que no esté todavía disponible localmente, dale un poco de tiempo para que se descargue las fuentes y el código al final aparecerá. De no ser así el código fuente probablemente no esté disponible y necesites seguir leyendo.</span></p>
          <p>Estos son los pasos que tienes que seguir en caso de que quieras enlazar una librería con su código fuente en la configuración de depuración:</p>
          <ol>
          	<li>Selecciona la opción <code>Run &gt; Debug Configurations...</code> en la barra de menu principal</li>
          	<li>Selecciona el nombre de la clase de test en la categoría JUnit (o TestNG)</li>
          	<li>Selecciona la pestaña Source (Fuente)</li>
          	<li>Haz click en el botón Add&#8230; a la derecha</li>
          	<li>Si el código fuente está en otro proyecto:
          	<ol>
          		<li>Selecciona Java Project</li>
          		<li>Marca el proyecto que contiene la clase que quieres depurar</li>
          		<li>Haz click en OK en la ventana de seleccion de proyecto (Project Selection)</li>
          	</ol></li>
          	<li>Si el código fuente está en una librería
          	<ol>
          		<li>Selecciona External Archive</li>
          		<li>Navega hasta el archivo que contiene el código fuente (que, por supuesto, te tienes que descargar tú mismo)</li>
          	</ol></li>
          	<li>Haz click en Close en la ventana de Debug Configurations</li>
          </ol>
          <p>Tienes que repetir estos pasos para cada clase que quieras depurar, aunque solo tienes que hacerlo una vez (la configuración de depuración se queda para siempre).</p>
          <h3 id="depurar_en_un_servidor_administrado">Depurar en un servidor administrado</h3>
          <p>¿Es posible depurar usando un contenedor administrado? ¡Por supuesto que sí! Sólo necesitamos un poco más de configuración.</p>
          <p>Ya que es Arquillian quién se encarga de arrancar y parar el contenedor tenemos que instruirle para que lo haga en modo depuración. Hay una propiedad de la JVM que Arquillian tiene que pasar al servidor usando las propiedades de configuración del contenedor.</p>
          <p>Antes de ponernos con eso, tenemos que pensar cómo vamos a conectar el depurador. A menos que seas super rápido con el ratón vas a tenerlo difícil para conectar el depurador antes de que Arquillian empiece a ejecutar los tests. Afortunadamente podemos pedirle a la JVM que espere a que el depurador se conecte antes de ejecutar la aplicación, en este caso JBoss AS. Eso nos da el tiempo suficiente para pulsar el botón de depuración en el IDE para conectarnos al proceso.</p>
          <p>Esta es la configuración que tienes que añadir al descriptor de configuración de Arquillian, arquillian.xml, para que Arquillian arranque el servidor en modo depuración: (No se permiten espacios justo después de la etiqueta <code>&lt;property&gt;</code>)</p>
          <div class="filename">src/test/resources/arquillian.xml</div>
          <pre class="prettify"><code class="prettify">&lt;arquillian xmlns="http://jboss.org/schema/arquillian"&#x000A;    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&#x000A;    xsi:schemaLocation="&#x000A;        http://jboss.org/schema/arquillian&#x000A;        http://jboss.org/schema/arquillian/arquillian_1_0.xsd"&gt;&#x000A;    &lt;container qualifier="jbossas-managed" default="true"&gt;&#x000A;        &lt;configuration&gt;&#x000A;            &lt;property name="jbossHome"&gt;target/jboss-as-7.1.1.Final&lt;/property&gt;&#x000A;            &lt;property name="javaVmArguments"&gt;-Xmx512m -XX:MaxPermSize=128m&#x000A;                -Xrunjdwp:transport=dt_socket,address=8787,server=y,suspend=y&#x000A;            &lt;/property&gt;&#x000A;        &lt;/configuration&gt;&#x000A;    &lt;/container&gt;&#x000A;&lt;/arquillian&gt;</code></pre>
          <p>Fíjate en la opción <code>suspend=y</code>. Eso le dice al proceso que espere a que se conecte el depurador. Hemos configurado el puerto de depuración en el 8787, que es el puerto que tienes que poner en la configuración del depurador. Llegaremos a eso en un momento. Primero comencemos el test.</p>
          <ol>
          	<li>Activa el perfil de Maven <code>arquillian-jbossas-managed</code> (Consulta la <a href="/guides/getting_started_es">Guía de introducción</a>)</li>
          	<li>Ejecuta el test</li>
          </ol>
          <p>En la consola deberías ver que Arquillian ha arrancado la instancia de JBoss AS y que está esperando a que se conecte el depurador:</p>
          <pre class="output"><code class="output">Listening for transport dt_socket at address: 8787</code></pre>
          <p>Lo único que tenemos que hacer ahora es conectar un depurador. Así es como se lanza el depurador en Eclipse:</p>
          <ol>
          	<li>Selecciona <code>Run &gt; Debug Configurations...</code> en el menú principal</li>
          	<li>Haz click con el botón derecho en Remote Java Application y selecciona New</li>
          	<li>En el campo Name pon &#8220;Debug JBoss AS&#8221;</li>
          	<li>En el campo Port pon &#8220;8787&#8221;</li>
          	<li>Haz click en el botón Debug</li>
          </ol>
          <p>Aquí podemos ver la pantalla de configuración mostrando el perfil de depuración que acabamos de crear:</p>
          <p><img src="/images/guides/arquillian_tutorial_2_eclipse_debug_configuration.png" alt="" /></p>
          <p>Cuando pulses el botón Debug, JBoss AS debería reanudarse y después volverse a parar cuando alcance el breakpoint del test. ¡Voila! ¡Estás depurando un contenedor administrado!</p>
          <h3 id="exportar_el_despliegue">Exportar el despliegue</h3>
          <p>Algunas veces necesitas un poco más de información sobre lo que Arquillian despliega en el servidor. Afortunadamente Arquillian dispone de una forma de exportar el fichero de test justo antes de desplegarlo. Asigna un directorio absoluto o relativo a la propiedad <code>deploymentExportPath</code> del elemento <code>&lt;engine&gt;</code> en arquillian.xml y Arquillian exportará el archivo en esa ubicación cada vez que ejecutes un test de Arquillian.</p>
          <div class="filename">src/test/resources/arquillian.xml</div>
          <pre class="prettify"><code class="prettify">&lt;arquillian xmlns="http://jboss.org/schema/arquillian"&#x000A;    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&#x000A;    xsi:schemaLocation="&#x000A;        http://jboss.org/schema/arquillian&#x000A;        http://jboss.org/schema/arquillian/arquillian_1_0.xsd"&gt;&#x000A;    &lt;engine&gt;&#x000A;        &lt;property name="deploymentExportPath"&gt;target/deployments&lt;/property&gt;&#x000A;    &lt;/engine&gt;&#x000A;&lt;/arquillian&gt;</code></pre>
          <p>Para activar la exportación solo para un test usa el argumento de la máquina virtual <code>arquillian.deploymentExportPath</code>. Por ejemplo: <code>-Darquillian.deploymentExportPath=target/deployments/</code>.</p>
          <p>Ahora ejecuta un test y comprueba el directorio target/deployments. Deberías ver un fichero con la extensión .jar, .war o .ear (Puede ser que Arquillian haya empaquetado el archivo definido en el test dentro de otro archivo para añadirle un poco de magia). Puedes inspeccionar el contenido de este fichero usando un gestor de ficheros. Con suerte el contenido del fichero te dará la información suficiente para solucionar excepciones de clases o recursos ausentes.</p>
          <p>Hasta aquí has aprendido como ejecutar y depurar los tests en contenedores embebidos, remotos y administrados. No hay nada que te pueda detener. ¡Sigue escribiendo <em>tests de verdad</em> y haz que Ike se sienta orgulloso!</p>
          <h3 id="share">Share the Knowledge</h3>
          <p>Find this guide useful?</p>
          <p class="post_to_twitter"><a href="http://twitter.com/home/?status=Just%20read%20the%20%23Arquillian%20Gu%C3%ADa%20de%20introducci%C3%B3n:%20Aclarar%20y%20repetir%20guide%20and%20got%20a%20%23greenbar!%20Get%20yours.%20http://arquillian.org/guides/getting_started_rinse_and_repeat_es/"><img src="/images/post_to_twitter.png" alt="" /></a></p>
          <div class="g-plusone" data-size="tall"></div>
          <p>There&#8217;s a lot more about Arquillian to cover. If you&#8217;re ready to learn more, check out the <a href="/guides">other available guides</a>.</p>
          <h4>Feedback</h4>
          <p>Find a bug in the guide? Something missing? You can fix it by <a href="http://github.com/arquillian/arquillian.github.com">forking this website</a>, making the correction and <a href="http://help.github.com/send-pull-requests">sending a pull request</a>. If you&#8217;re just plain stuck, feel free to ask a question in the <a href="http://community.jboss.org/en/arquillian?view=discussions">user discussion forum</a>.</p>
          <h4>Recent Changelog</h4>
          <ul>
            <li>
              Mar 31, 2017:
              Drone release announcements (#372)
              <em>by Matous Jobanek</em>
            </li>
          </ul>
          <p>
            <a href="https://github.com/arquillian/arquillian.github.io/commits/develop/guides/getting_started_rinse_and_repeat_es.textile">See full history &raquo;</a>
          </p>
        </div>
        <div id="sidebar">
          <div id="toc">
            <h3 class="chapter_header">Chapters</h3>
            <ol class="chapters">
              <li>
                <a href="#asunciones" id="asunciones_link">Asunciones</a>
              </li>
              <li>
                <a href="#crear_los_componentes" id="crear_los_componentes_link">Crear los componentes</a>
              </li>
              <li>
                <a href="#implementaci&#243;n_por_fases" id="implementación_por_fases_link">Implementación por fases</a>
              </li>
              <li>
                <a href="#escribir_un_test" id="escribir_un_test_link">Escribir un test</a>
              </li>
              <li>
                <a href="#a&#241;adir_los_contenedores_remotos" id="añadir_los_contenedores_remotos_link">Añadir los Contenedores Remotos</a>
              </li>
              <li>
                <a href="#control_de_los_servidores" id="control_de_los_servidores_link">Control de los servidores</a>
              </li>
              <li>
                <a href="#ejecutar_el_test_con_arquillian" id="ejecutar_el_test_con_arquillian_link">Ejecutar el test con Arquillian</a>
              </li>
              <li>
                <a href="#depurar_el_test_de_arquillian" id="depurar_el_test_de_arquillian_link">Depurar el test de Arquillian</a>
              </li>
              <li>
                <a href="#depurar_en_un_servidor_administrado" id="depurar_en_un_servidor_administrado_link">Depurar en un servidor administrado</a>
              </li>
              <li>
                <a href="#exportar_el_despliegue" id="exportar_el_despliegue_link">Exportar el despliegue</a>
              </li>
              <li>
                <a href="#share" id="share_link">Share the Knowledge</a>
              </li>
            </ol>
          </div>
        </div>
        <script>
          $(window).load(function() { activateScrollingToc(['asunciones', 'crear_los_componentes', 'implementación_por_fases', 'escribir_un_test', 'añadir_los_contenedores_remotos', 'control_de_los_servidores', 'ejecutar_el_test_con_arquillian', 'depurar_el_test_de_arquillian', 'depurar_en_un_servidor_administrado', 'exportar_el_despliegue', 'share']) })
        </script>
      </div>
    </div>
    <footer>
      <div class="container">
        <div class="project">
          <img src="/images/arquillian_logo_200px.png" />
          <p class="bottom">
            &#169;
            Copyright 2009-2017 Red Hat, Inc.
            <br />
            <i class="icon-fire"></i>
            Mixed with <a href="http://twitter.github.com/bootstrap">Bootstrap</a>. Baked by <a href="http://awestruct.org">Awestruct</a>.
            <br />
            <i class="icon-share-alt"></i>
            Website and docs licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.
            <br />
            Code released under <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License, v2.0</a>.
          </p>
        </div>
        <div class="footer-nav">
          <h4>Learn</h4>
          <ul>
            <li>
              <a href="/invasion">Mission</a>
            </li>
            <li>
              <a href="/features">Features</a>
            </li>
            <li>
              <a href="/docs">Documentation</a>
            </li>
            <li>
              <a href="/guides">Guides</a>
            </li>
            <li>
              <a href="https://docs.jboss.org/author/display/ARQ/Reference+Guide">Manual</a>
            </li>
            <li>
              <a href="http://community.jboss.org/en/arquillian/faq">FAQs</a>
            </li>
          </ul>
        </div>
        <div class="footer-nav">
          <h4>Get Involved</h4>
          <ul>
            <li>
              <a href="http://community.jboss.org/en/arquillian?view=discussions">Forums</a>
            </li>
            <li>
              <a href="https://issues.jboss.org/browse/ARQ">Issue Tracker</a>
            </li>
            <li>
              <a href="https://github.com/arquillian">Source Code</a>
            </li>
            <li>
              <a href="/community/contributors">Contributors</a>
            </li>
            <li>
              <a href="https://community.jboss.org/groups/testing">Testing SIG</a>
            </li>
          </ul>
        </div>
        <div class="sponser">
          <div class="follow-us">
            <h4>Stay Informed</h4>
            <ul>
              <li>
                <a href="https://plus.google.com/100660127586085393031?rel=author"><img alt="Google+" src="/images/social/googleplus-16.png" title="Follow Arquillian on Google+" /></a>
              </li>
              <li>
                <a href="https://twitter.com/#!/search/%23arquillian"><img alt="Twitter" src="/images/social/twitter-16.png" title="Browse the #arquillian hashtag on Twitter" /></a>
              </li>
              <li>
                <a href="http://www.linkedin.com/groups?gid=3120340"><img alt="LinkedIn" src="/images/social/linkedin-16.png" title="Join the Arquillian group on LinkedIn" /></a>
              </li>
              <li>
                <a href="http://vimeo.com/channels/arquillian"><img alt="Vimeo" src="/images/social/vimeo-16.png" title="Follow the Arquillian channel on Vimeo" /></a>
              </li>
            </ul>
          </div>
          <p>This website is open source! If you want to improve it, <a href="http://github.com/arquillian/arquillian.github.com">fork the project</a>, hack on it, then send a <a href="https://help.github.com/articles/using-pull-requests">pull request</a>. You can also view the <a href="http://www.seethestats.com/site/arquillian.org">visitor stats</a>.</p>
          <p class="image"><a href="http://jboss.org"><img src="/images/jboss_redhat_branding.png" class="branding" title="Red Hat, Inc." alt="Red Hat, Inc." /></a></p>
          <p>Arquillian is a <a href="http://jboss.org">JBoss Community</a> project and development is sponsored by Red Hat, Inc.</p>
          <p class="bottom"><a href="http://www.redhat.com/legal/legal_statement.html">Terms of Use</a> | <a href="http://www.redhat.com/legal/privacy_statement.html">Privacy Policy</a></p>
        </div>
        <a class="visible-desktop" href="#" id="toTop">Top</a>
      </div>
    </footer>
    <script>
      $(function() {
        $('html').addClass('ready');
        prettify();
        activateFooterGravity();
        activateTooltips();
        activateToTopControl();
      });
    </script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.0.2/bootstrap.min.js"></script>
    <script src="/javascripts/prettify.js"></script>
    <script src="/javascripts/site.js?9af4bcf5a328ba81be7679268e4a9f4eefe09ea1"></script>
    <script src="/javascripts/jquery-scroll.js"></script>
    <script src="http://apis.google.com/js/plusone.js"></script>
    <script>
      (function() {
        var po = document.createElement('script'); po.async = true; po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })();
    </script>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount','UA-18727998-3']);
    _gaq.push(['_trackPageview']);
    (function() {
     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
     ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
  </body>
</html>
